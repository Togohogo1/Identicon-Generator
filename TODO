fix function order
add better comments
reformat code
massive variable renaming operation
